<!--
	class: class of the figure
	link: url the image directs to
	src: image link
	alt: alternative text
	caption: text underneath
	mouse: what the image says when moused over ("title" in HTML)
	ratio: aspect ratio of the image (in "x / y") for better dom loading
-->
{{ $zoom := 0 -}}
{{ with .Get "zoomsrc" -}}
	{{ $zoom = 1 -}}
	{{ $.Scratch.Set "link" . -}}
{{ else -}}
	{{ with .Get "link" -}}
		{{ $.Scratch.Set "link" . -}}
	{{ end -}}
{{ end -}}
{{ $link := $.Scratch.Get "link" -}}
{{ $imageLink := (.Get "src") -}}
<figure {{ with .Get "class" }}class="{{ . }}"{{ end -}}>
	{{ if eq $zoom 1 }}<div class="easyzoom easyzoom--overlay">{{ end -}}
	{{- with $link }}<a href="{{ . }}">{{ end -}}
	<img {{ if not (.Get "nolazy") }}loading="lazy" {{ end -}}
		src="{{ $imageLink }}"
		{{- with .Get "mouse" }} title="{{ . }}"{{ end -}}
		{{- with .Get "alt" }} alt="{{ . }}"{{ end -}}
		{{- with .Get "ratio" }} {{ printf "style=%q" (printf "%s:%s" "aspect-ratio" (replace . " " "")) | safeHTMLAttr }}{{ end -}}
		{{/**/}} width="100%" height="100%"/>
	{{- if $link }}</a>{{ end -}}
	{{ if eq $zoom 1 }}</div>{{ end -}}

	{{- with .Get "caption" -}}
	<figcaption>
	{{- . -}}
	</figcaption>
	{{- end }}
</figure>